{"description": "Enterprise techniques used by OilRig, ATT&CK group G0049 v1.0", "name": "OilRig (G0049)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1194", "techniqueName": "Spearphishing via Service", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used LinkedIn to send spearphishing links. "}, {"score": 1, "techniqueID": "T1043", "techniqueName": "Commonly Used Port", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used port 80 to call back to the C2 server.\t"}, {"score": 1, "techniqueID": "T1081", "techniqueName": "Credentials in Files", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used tools named VALUEVAULT and PICKPOCKET to dump passwords from web browsers.\t"}, {"score": 1, "techniqueID": "T1113", "techniqueName": "Screen Capture", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has a tool called CANDYKING to capture a screenshot of user's desktop."}, {"score": 1, "techniqueID": "T1046", "techniqueName": "Network Service Scanning", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning."}, {"score": 1, "techniqueID": "T1133", "techniqueName": "External Remote Services", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) uses remote services such as VPN, Citrix, or OWA to persist in an environment."}, {"score": 1, "techniqueID": "T1047", "techniqueName": "Windows Management Instrumentation", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used WMI for execution."}, {"score": 1, "techniqueID": "T1053", "techniqueName": "Scheduled Task", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has created scheduled tasks that run a VBScript to execute a payload on victim machines."}, {"score": 1, "techniqueID": "T1056", "techniqueName": "Input Capture", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used keylogging tools called KEYPUNCH and LONGWATCH.\t\n"}, {"score": 1, "techniqueID": "T1110", "techniqueName": "Brute Force", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used brute force techniques to obtain credentials."}, {"score": 1, "techniqueID": "T1204", "techniqueName": "User Execution", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has delivered malicious links and macro-enabled documents that required targets to click the \"enable content\" button to execute the payload on the system."}, {"score": 1, "techniqueID": "T1193", "techniqueName": "Spearphishing Attachment", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts."}, {"score": 1, "techniqueID": "T1192", "techniqueName": "Spearphishing Link", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has sent spearphising emails with malicious links to potential victims."}, {"score": 1, "techniqueID": "T1201", "techniqueName": "Password Policy Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used net.exe in a script with <code>net accounts /domain</code> to find the password policy of a domain."}, {"score": 1, "techniqueID": "T1032", "techniqueName": "Standard Cryptographic Protocol", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) used the Plink utility and other tools to create tunnels to C2 servers."}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Remote File Copy", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) can download remote files onto victims."}, {"score": 1, "techniqueID": "T1223", "techniqueName": "Compiled HTML File", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used a CHM payload to load and execute another malicious file once delivered to a victim."}, {"score": 1, "techniqueID": "T1057", "techniqueName": "Process Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>tasklist</code> on a victim's machine."}, {"score": 1, "techniqueID": "T1140", "techniqueName": "Deobfuscate/Decode Files or Information", "comment": "A [OilRig](https://attack.mitre.org/groups/G0049) macro has run a PowerShell command to decode file contents. [OilRig](https://attack.mitre.org/groups/G0049) has also used [certutil](https://attack.mitre.org/software/S0160) to decode base64-encoded files on victims."}, {"score": 1, "techniqueID": "T1094", "techniqueName": "Custom Command and Control Protocol", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used custom DNS Tunneling protocols for C2."}, {"score": 1, "techniqueID": "T1119", "techniqueName": "Automated Collection", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used automated collection."}, {"score": 1, "techniqueID": "T1107", "techniqueName": "File Deletion", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has deleted files associated with their payload after execution."}, {"score": 1, "techniqueID": "T1108", "techniqueName": "Redundant Access", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used [RGDoor](https://attack.mitre.org/software/S0258) via Web shell to establish redundant access. The group has also used harvested credentials to gain access to Internet-accessible resources such as Outlook Web Access, which could be used for redundant access."}, {"score": 1, "techniqueID": "T1021", "techniqueName": "Remote Services", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used Putty to access compromised systems."}, {"score": 1, "techniqueID": "T1069", "techniqueName": "Permission Groups Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>net group /domain</code>, <code>net localgroup administrators</code>, <code>net group \u201cdomain admins\u201d /domain</code>, and <code>net group \u201cExchange Trusted Subsystem\u201d /domain</code> to find group permission settings on a victim."}, {"score": 1, "techniqueID": "T1064", "techniqueName": "Scripting", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used various types of scripting for execution, including .bat and .vbs scripts. The group has also used macros to deliver malware such as [QUADAGENT](https://attack.mitre.org/software/S0269) and [OopsIE](https://attack.mitre.org/software/S0264)."}, {"score": 1, "techniqueID": "T1076", "techniqueName": "Remote Desktop Protocol", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment."}, {"score": 1, "techniqueID": "T1049", "techniqueName": "System Network Connections Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>netstat -an</code> on a victim to get a listing of network connections."}, {"score": 1, "techniqueID": "T1007", "techniqueName": "System Service Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>sc query</code> on a victim to gather information about services."}, {"score": 1, "techniqueID": "T1059", "techniqueName": "Command-Line Interface", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used the command-line interface for execution."}, {"score": 1, "techniqueID": "T1016", "techniqueName": "System Network Configuration Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>ipconfig /all</code> on a victim."}, {"score": 1, "techniqueID": "T1082", "techniqueName": "System Information Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>hostname</code> and <code>systeminfo</code> on a victim.\t"}, {"score": 1, "techniqueID": "T1012", "techniqueName": "Query Registry", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used <code>reg query \u201cHKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\u201d</code> on a victim to query the Registry."}, {"score": 1, "techniqueID": "T1071", "techniqueName": "Standard Application Layer Protocol", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used HTTP and DNS for C2. The group has also used the Plink utility and other tools to create tunnels to C2 servers."}, {"score": 1, "techniqueID": "T1087", "techniqueName": "Account Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>net user</code>, <code>net user /domain</code>, <code>net group \u201cdomain admins\u201d /domain</code>, and <code>net group \u201cExchange Trusted Subsystem\u201d /domain</code> to get account listings on a victim."}, {"score": 1, "techniqueID": "T1048", "techniqueName": "Exfiltration Over Alternative Protocol", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has exfiltrated data over FTP separately from its primary C2 channel over DNS."}, {"score": 1, "techniqueID": "T1003", "techniqueName": "Credential Dumping", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used credential dumping tools such as [Mimikatz](https://attack.mitre.org/software/S0002) and [LaZagne](https://attack.mitre.org/software/S0349) to steal credentials to accounts logged into the compromised system and to Outlook Web Access."}, {"score": 1, "techniqueID": "T1008", "techniqueName": "Fallback Channels", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) malware ISMAgent falls back to its DNS tunneling mechanism if it is unable to reach the C2 server over HTTP."}, {"score": 1, "techniqueID": "T1033", "techniqueName": "System Owner/User Discovery", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has run <code>whoami</code> on a victim."}, {"score": 1, "techniqueID": "T1086", "techniqueName": "PowerShell", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used PowerShell scripts for execution, including use of a macro to run a PowerShell command to decode file contents."}, {"score": 1, "techniqueID": "T1027", "techniqueName": "Obfuscated Files or Information", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has encrypted and encoded data in its malware, including by using base64."}, {"score": 1, "techniqueID": "T1100", "techniqueName": "Web Shell", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used Web shells, often to maintain access to a victim network."}, {"score": 1, "techniqueID": "T1078", "techniqueName": "Valid Accounts", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has used compromised credentials to access other systems on a victim network."}, {"score": 1, "techniqueID": "T1066", "techniqueName": "Indicator Removal from Tools", "comment": "[OilRig](https://attack.mitre.org/groups/G0049) has tested malware samples to determine AV detection and subsequently modified the samples to ensure AV evasion."}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by OilRig", "color": "#ff6666"}]}