{"description": "Enterprise techniques used by Turla, ATT&CK group G0010 v1.0", "name": "Turla (G0010)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1022", "techniqueName": "Data Encrypted", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has encrypted files stolen from connected USB drives into a RAR file before exfiltration."}, {"score": 1, "techniqueID": "T1048", "techniqueName": "Exfiltration Over Alternative Protocol", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used WebDAV to upload stolen USB files to a cloud drive."}, {"score": 1, "techniqueID": "T1064", "techniqueName": "Scripting", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used PowerShell and VBS scripts throughout its operations.\t"}, {"score": 1, "techniqueID": "T1081", "techniqueName": "Credentials in Files", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has gathered credentials from the Windows Credential Manager tool.\t"}, {"score": 1, "techniqueID": "T1059", "techniqueName": "Command-Line Interface", "comment": "[Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have used cmd.exe to execute commands."}, {"score": 1, "techniqueID": "T1005", "techniqueName": "Data from Local System", "comment": "[Turla](https://attack.mitre.org/groups/G0010) RPC backdoors can upload files from victim machines."}, {"score": 1, "techniqueID": "T1134", "techniqueName": "Access Token Manipulation", "comment": "[Turla](https://attack.mitre.org/groups/G0010) RPC backdoors can impersonate or steal process tokens before executing commands.\t"}, {"score": 1, "techniqueID": "T1025", "techniqueName": "Data from Removable Media", "comment": "[Turla](https://attack.mitre.org/groups/G0010) RPC backdoors can collect files from USB thumb drives."}, {"score": 1, "techniqueID": "T1090", "techniqueName": "Connection Proxy", "comment": "[Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have included local UPnP RPC proxies.\t"}, {"score": 1, "techniqueID": "T1140", "techniqueName": "Deobfuscate/Decode Files or Information", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used a custom decryption routine, which pulls key and salt values from other artifacts such as a WMI filter or [PowerShell Profile](https://attack.mitre.org/techniques/T1504), to decode encrypted PowerShell payloads."}, {"score": 1, "techniqueID": "T1089", "techniqueName": "Disabling Security Tools", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used a AMSI bypass, which patches the in-memory amsi.dll, in PowerShell scripts to bypass Windows antimalware products."}, {"score": 1, "techniqueID": "T1106", "techniqueName": "Execution through API", "comment": "[Turla](https://attack.mitre.org/groups/G0010) and its RPC backdoors have used APIs calls for various tasks related to subverting AMSI and accessing then executing commands through RPC and/or named pipes."}, {"score": 1, "techniqueID": "T1084", "techniqueName": "Windows Management Instrumentation Event Subscription", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used WMI event filters and consumers to establish persistence."}, {"score": 1, "techniqueID": "T1027", "techniqueName": "Obfuscated Files or Information", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used encryption (including salted 3DES via [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Out-EncryptedScript.ps1</code>), random variable names, and base64 encoding to obfuscate PowerShell commands and payloads."}, {"score": 1, "techniqueID": "T1112", "techniqueName": "Modify Registry", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used the Registry to store encrypted payloads."}, {"score": 1, "techniqueID": "T1504", "techniqueName": "PowerShell Profile", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used PowerShell profiles to maintain persistence on an infected machine."}, {"score": 1, "techniqueID": "T1193", "techniqueName": "Spearphishing Attachment", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used spearphishing emails to deliver [BrainTest](https://attack.mitre.org/software/S0293) as a malicious attachment."}, {"score": 1, "techniqueID": "T1192", "techniqueName": "Spearphishing Link", "comment": "[Turla](https://attack.mitre.org/groups/G0010) attempted to trick targets into clicking on a link featuring a seemingly legitimate domain from Adobe.com to download their malware and gain initial access."}, {"score": 1, "techniqueID": "T1086", "techniqueName": "PowerShell", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used PowerShell to execute commands/scripts, in some cases via a custom executable or code from [Empire](https://attack.mitre.org/software/S0363)'s PSInject. [Turla](https://attack.mitre.org/groups/G0010) has also used PowerShell scripts to load and execute malware in memory."}, {"score": 1, "techniqueID": "T1060", "techniqueName": "Registry Run Keys / Startup Folder", "comment": "A [Turla](https://attack.mitre.org/groups/G0010) Javascript backdoor added a local_update_check value under the Registry key <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run</code> to establish persistence. Additionally, a [Turla](https://attack.mitre.org/groups/G0010) custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence."}, {"score": 1, "techniqueID": "T1102", "techniqueName": "Web Service", "comment": "A [Turla](https://attack.mitre.org/groups/G0010) JavaScript backdoor has used Google Apps Script as its C2 server."}, {"score": 1, "techniqueID": "T1055", "techniqueName": "Process Injection", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used Metasploit to perform reflective DLL injection in order to escalate privileges. [Turla](https://attack.mitre.org/groups/G0010) has also used [PowerSploit](https://attack.mitre.org/software/S0194)'s <code>Invoke-ReflectivePEInjection.ps1</code> to reflectively load a PowerShell payload into a random process on the victim system."}, {"score": 1, "techniqueID": "T1204", "techniqueName": "User Execution", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used spearphishing via a link to get users to download and run their malware."}, {"score": 1, "techniqueID": "T1105", "techniqueName": "Remote File Copy", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used shellcode to download Meterpreter after compromising a victim. [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors can also download files onto victim machines."}, {"score": 1, "techniqueID": "T1004", "techniqueName": "Winlogon Helper DLL", "comment": "[Turla](https://attack.mitre.org/groups/G0010) established persistence by adding a Shell value under the Registry key <code>HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion]Winlogon</code>."}, {"score": 1, "techniqueID": "T1071", "techniqueName": "Standard Application Layer Protocol", "comment": "[Turla](https://attack.mitre.org/groups/G0010) has used HTTP and HTTPS for C2 communications."}, {"score": 1, "techniqueID": "T1066", "techniqueName": "Indicator Removal from Tools", "comment": "Based on comparison of [Gazer](https://attack.mitre.org/software/S0168) versions, [Turla](https://attack.mitre.org/groups/G0010) made an effort to obfuscate strings in the malware that could be used as IoCs, including the mutex name and named pipe."}, {"score": 1, "techniqueID": "T1110", "techniqueName": "Brute Force", "comment": "[Turla](https://attack.mitre.org/groups/G0010) may attempt to connect to systems within a victim's network using <code>net use</code> commands and a predefined list or collection of passwords."}, {"score": 1, "techniqueID": "T1012", "techniqueName": "Query Registry", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover information in the Windows Registry with the <code>reg query</code> command. [Turla](https://attack.mitre.org/groups/G0010) has also retrieved PowerShell payloads hidden in Registry keys as well as checking keys associated with null session named pipes ."}, {"score": 1, "techniqueID": "T1083", "techniqueName": "File and Directory Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover files in specific locations on the hard disk %TEMP% directory, the current user's desktop, and in the Program Files directory. [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also searched for files matching the <code>lPH*.dll</code> pattern."}, {"score": 1, "techniqueID": "T1018", "techniqueName": "Remote System Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover remote systems on a local network using the <code>net view</code> and <code>net view /DOMAIN</code> commands."}, {"score": 1, "techniqueID": "T1082", "techniqueName": "System Information Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover operating system configuration details using the <code>systeminfo</code> and <code>set</code> commands."}, {"score": 1, "techniqueID": "T1049", "techniqueName": "System Network Connections Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover active local network connections using the <code>netstat -an</code>, <code>net use</code>, <code>net file</code>, and <code>net session</code> commands. [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also enumerated the IPv4 TCP connection table via the <code>GetTcpTable2</code> API call."}, {"score": 1, "techniqueID": "T1077", "techniqueName": "Windows Admin Shares", "comment": "[Turla](https://attack.mitre.org/groups/G0010) used <code>net use</code> commands to connect to lateral systems within a network."}, {"score": 1, "techniqueID": "T1124", "techniqueName": "System Time Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover the system time by using the <code>net time</code> command."}, {"score": 1, "techniqueID": "T1007", "techniqueName": "System Service Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover running services and associated processes using the <code>tasklist /svc</code> command."}, {"score": 1, "techniqueID": "T1016", "techniqueName": "System Network Configuration Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover network configuration details using the <code>arp -a</code>, <code>nbtstat -n</code>, <code>nbtscan</code>, and <code>net config</code> commands. [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also retrieved registered RPC interface information from process memory."}, {"score": 1, "techniqueID": "T1057", "techniqueName": "Process Discovery", "comment": "[Turla](https://attack.mitre.org/groups/G0010) surveys a system upon check-in to discover running processes using the <code>tasklist /v</code> command. [Turla](https://attack.mitre.org/groups/G0010) RPC backdoors have also enumerated processes associated with specific open ports or named pipes."}], "gradient": {"colors": ["#ffffff", "#ff6666"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Turla", "color": "#ff6666"}]}